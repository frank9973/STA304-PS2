---
title: "Title of Your Report"
author: "Jiaheng Li, Heye Liu, Yan Wang, Yuxin Yang"
date: "18/10/2020"
output: pdf_document
---

```{r setup, include=FALSE}
library(janitor)
library(tidyverse)
library(ggplot2)
library(tinytex)
tinytex::install_tinytex()
# Load the data dictionary and the raw data and correct the variable names
raw_data <- read_csv("gss.csv")
dataset <- raw_data %>% select(caseid, age, total_children, sex, feelings_life, marital_status, average_hours_worked, income_respondent, self_rated_health)
```

## Title of your Report

# Jiaheng Li, Heye Liu, Yan Wang, Yuxin Yang
# October 18, 2020


## Abstract

This project’s purpose is to analyze the potential influence of personal life conditions on life happiness based on the Canadian General Social Survey. More specifically, we focus on how these factors could affect people’s “feeling about life as a whole”. Statistical models are used in the analyses, including [……]. The analysis results leading to the conclusion of that [……].

## Introduction

With the rapid development of modern cities, people’s quality of life seems to be improving, there are more convenient transportations, communication equipment, more diverse form of entertainments. But it seems that people’s pace of life has become urgent up. Many people live a two-point life while have to find a balance of work and family. There is very little time left for personal enjoyment. Many people start thinking and asking: Do I really like my life? How is my feeling about my life as a whole? We are also part of the busy crowd, so we are interested in the factors that influence people’s happiness in life. Canadian General Social Survey recorded information about the basic living conditions of Canadian people and how they feel about their current life. In our study, we will choose several of these variables we think may have an impact on life satisfaction. We will use statistical models to help us visualize the relationship between these variables Xs’ and our Y value, the score of “feelings about life as a whole”. To find out eventually, how people’s different life conditions may bring positive or negative influences to their life satisfaction. More detailed information about the variables and models will be further explained in the sections after.

## Data

  We chose to analyze the General social survey data on Family (cycle 31), 2017 from the U of T library, provided by Statistics Canada under the terms of the Data Liberation Initiative (DLI) license. The survey collected a large amount of data for each selected respondent as well as some information about each member of the respondent’s household, including age, sex, family origins, conjugal history, the respondent’s children, financial condition, labor market activity, subjective well-being and feelings about life as a whole. 
  
  The target population of this survey includes all persons 15 years of age and older in Canada. It used the redesigned GSS frame, integrating data from sources of both landline and cellular phone numbers available to Statistics Canada and the Address Register. The sample population was obtained with stratification. Provinces and many Census Metropolitan Areas (CMAs) were considered as separate stratum, and each record in the survey frame was assigned to a stratum. Then a simple random sample without replacement of records was performed in each stratum. Any household with no telephone or at least one person 15 years of age or older was excluded from the survey. Respondents were then randomly selected from eligible households and participated in the survey through telephone interview. The survey involved 20602 respondents in total and recorded 81 variables.
  
  We downloaded the raw csv dataset for STATA, cleaned and prepared it in R with the gss_cleaning file provided ahead alongside the problem set question. The gss_cleaning file converts the raw dataset into a dictionary type dataset with renamed variables. In order to analyze the effect of personal life situation on the life satisfaction score, we select the variables below:
  
+ sex: the sex of the respondent;

+ marital_status: the marital status of the respondent;

+ total_children: the total number of children the respondent has, as self-reported;

+ average_hours_worked: the average number of hours worked per week;

+ income_respondent:  the total income of respondent received in the calendar year 2016 from all sources before income taxes and deductions;

+ self_rated_health: self rated health of respondent, ranging from excellent to poor;

+ feelings_life: feelings about life as a whole using a scale of 0 to 10, where 0 means "very dissatisfied" and 10 means "very satisfied".



## Results
Firstly, we create a multiple linear model for feelings_life with self_rated_health vs ages.
***model***
```{r echo=FALSE}
dataset$self_rated_health <- as.character(dataset$self_rated_health)
dataset$self_rated_health[dataset$self_rated_health == "Don't know"] <- 0
dataset$self_rated_health[dataset$self_rated_health == "Poor"] <- 1
dataset$self_rated_health[dataset$self_rated_health == "Fair"] <- 2
dataset$self_rated_health[dataset$self_rated_health == "Good"] <- 3
dataset$self_rated_health[dataset$self_rated_health == "Very good"] <- 4
dataset$self_rated_health[dataset$self_rated_health == "Excellent"] <- 5
dataset$age[dataset$age <= 20] <- "0-20"
dataset$age[20.1 <= dataset$age  & dataset$age<= 40] <- "20-40"
dataset$age[40.1 <= dataset$age  & dataset$age<= 60] <- "40-60"
dataset$age[60.1 <= dataset$age  & dataset$age<= 80] <- "60-80"
dataset$age[80.1 <= dataset$age] <- "80-100"

model <- lm(feelings_life ~ age + self_rated_health, data = dataset)
summary(model)
```

In addition, we make four different bar plots to reflects the impact of physical fitness on people's feeling_life at different ages. In these plots, we use use (1, 2, 3, 4, 5)  to correspond to (poor, fair, good, verygood, excellent) in the variable self_rated_health. Moreover, The age groups of these four bar plots are 0-20, 20-40, 40-60 and 60-80 respectively.

***Figure1***:

```{r echo=FALSE}
dataset$feelings_life[dataset$feelings_life == 1] <- "1-2"
dataset$feelings_life[dataset$feelings_life == 2] <- "1-2"
dataset$feelings_life[dataset$feelings_life == 3] <- "3-4"
dataset$feelings_life[dataset$feelings_life == 4] <- "3-4"
dataset$feelings_life[dataset$feelings_life == 5] <- "5-6"
dataset$feelings_life[dataset$feelings_life == 6] <- "5-6"
dataset$feelings_life[dataset$feelings_life == 7] <- "7-8"
dataset$feelings_life[dataset$feelings_life == 8] <- "7-8"
dataset$feelings_life[dataset$feelings_life == 9] <- "9-10"
dataset$feelings_life[dataset$feelings_life == 10] <- "9-10"
#show a box plot for income_respondent and feelings_life
dd <- dataset %>% filter(age == "0-20")
dd <- dd[order(dd$self_rated_health), ]
ggplot(dd, aes(self_rated_health)) + geom_bar(aes(fill = feelings_life))
```

For Figure1, we can see that in the ages of 0-20, the more healthy people are, the greater the percentage of those with a happiness index of 9 to 10. From the graph, we can clearly observe that the healthier people are at this age, the happier most of them will be in life.

***Figure2***:

```{r echo=FALSE}
dd <- dataset %>% filter(age == "20-40")
dd <- dd[order(dd$self_rated_health), ]
ggplot(dd, aes(self_rated_health)) + geom_bar(aes(fill = feelings_life))
```

For figrue2, it shows that in the age group of 20-40, There were more participants in this age group than in the 0-20 age group. And when the health status of participants at this age is good, very good or excellent, The proportion of people with a life happiness index less than or equal to 4 is higher than those with the same health status in the age group of 0-20. The reason for this may be that most people in this age group are under a lot of pressure from work, society and family. These kinds of stress may affect their level of feeling life. However, it is the same as the 0-20 age group, at this age group, a person's health status is about good, the happiness index will be high.

***Figure3***:

```{r echo=FALSE}
dd <- dataset %>% filter(age == "40-60")
dd <- dd[order(dd$self_rated_health), ]
ggplot(dd, aes(self_rated_health)) + geom_bar(aes(fill = feelings_life))
```

For figrue3, we cam make the same conclusion as the age group for 20-40,  the healthier people are at this age, the happier most of them will be in life. The proportion of people with different levels of feeling life in different health states is basically the same as that of the 20-40 age group. 

***Figure4***:

```{r echo=FALSE}
dd <- dataset %>% filter(age == "60-80")
dd <- dd[order(dd$self_rated_health), ]
ggplot(dd, aes(self_rated_health)) + geom_bar(aes(fill = feelings_life))
```

For figrue4, we also can get the conclusion that at this age group, a person's health status is about good, the happiness index will be high. There is a difference at this age group that among the people whose health status is "good", the proportion of people with a happiness index of 9-10 is higher than that of the previous three age groups. This difference may be caused by the difference in age. In the 60-80 age group, people's health is generally not as good as before, so they are not too nervous about the decline of their physical health. Moreover, most people in this age group have retired and do not have as much pressure as when they were young. So, the level of feeling life is a little higher than the first three ages.






